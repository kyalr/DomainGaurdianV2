<!doctype html><html><head><script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script><style>body{font-family:Arial,sans-serif;padding:20px;text-align:center}h1{color:#333}button{padding:10px;font-size:16px;background-color:#0078d4;color:#fff;border:none;cursor:pointer}#message{margin-top:20px;padding:10px;border:1px solid #ccc;text-align:left}</style><script defer="defer" src="polyfill.js"></script><script defer="defer" src="taskpane.js"></script></head><body><button id="helloButton">Domains Extract</button><div id="message"></div><script>let item;function getAllRecipients(){let e,t,i;document.getElementById("message").innerText="";let n=new Set;function s(e){e.forEach((e=>{let t=e.emailAddress,i=t.substring(t.indexOf("@")+1);n.add(i)}))}item.itemType===Office.MailboxEnums.ItemType.Appointment?(e=item.requiredAttendees,t=item.optionalAttendees):(e=item.to,t=item.cc,i=item.bcc),e.getAsync((e=>{e.status!==Office.AsyncResultStatus.Failed?(s(e.value),t.getAsync((e=>{e.status!==Office.AsyncResultStatus.Failed?(s(e.value),i.length>0?i.getAsync((e=>{e.status!==Office.AsyncResultStatus.Failed?(s(e.value),n.forEach((e=>{write(e)}))):write(e.error.message)})):n.forEach((e=>{write(e)}))):write(e.error.message)}))):write(e.error.message)}))}function write(e){document.getElementById("message").innerText+=e+"\n"}Office.onReady((e=>{e.host===Office.HostType.Outlook&&(item=Office.context.mailbox.item,document.getElementById("helloButton").onclick=getAllRecipients)}))</script></body></html>